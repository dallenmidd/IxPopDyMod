---
title: "Temperature-dependent transitions"
output: github_document
---

```{r setup, include=FALSE}
library(IxPopDyMod)
library(tidyverse)
```

## The `config` file

In this simple vignette, I give an example where some of the life-stage transitions are temperature dependent. Here I load the `config` and show the transitions

```{r}
cfg <- read_config('config_local.yml')
cfg$transitions
```

From the first line, you see that the development from eggs, `__e`, to questing larvae, `q_l`, is an exponential function of temperature. We can see the parameters for this transition:

```{r}
cfg$parameters %>% filter(from == '__e', to == 'q_l')
```

The daily development rate is 0.0000292*temp^2.27.

## Compare two temperature scenarios

Here I highlight how this temperature dependence affects the output of the model. I make a second `config` in which the daily temperature is one degree warmer.

```{r}

cfg2 <- cfg
cfg2$weather <- cfg$weather %>% mutate(tmean = tmean + 1)

output1 <- run(cfg)
output2 <- run(cfg2)

output1 <- output1 %>% mutate(temp = 'cold')
output2 <- output2 %>% mutate(temp = 'warm')
```

Finally I compare the outputs for a commonly measured aspect of tick populations, the number of questing nymphs. 

```{r}
output1 %>%
  rbind(output2) %>% 
  filter(stage == 'q_n') %>%
  ggplot(aes(day, pop, col = temp)) +
  geom_line() +
  scale_color_manual(values = c('cold' = 'blue', 'warm' = 'red')) +
  ylab('Questing nymphs')
```

Here you can see nymphs start questing earlier and reach a higher population in the warmer climate. 
